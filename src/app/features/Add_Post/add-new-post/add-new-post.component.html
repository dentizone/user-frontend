<div class="mx-10 my-5 ">
    <h2 class="text-xl font-semibold lg:text-3xl lg:font-bold">Add Post</h2>
    <hr class="mt-3"/>
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="flex flex-col justify-center items-center mt-5 min-w-full min-h-1/2 lg:grid lg:grid-cols-3">
        <div class="flex flex-col justify-center items-center rounded-2xl p-5 w-3/4 bg-[#E9F6FF]">
           @if (imagePreviews.length==0) {
            <img class="w-3/4 mb-4" src="/assets/Icons/image-gallery.png"/>
            }@else {
            <div class="relative w-3/4 mb-4">
                <img 
                    src="/assets/Icons/delete.png" 
                    class="absolute top-0 right-0 w-6 h-6 cursor-pointer z-10" 
                    (click)="onDelete(selectedImg.index)"
                />
                <img 
                    *ngIf="selectedImg.path === '' || selectedImg.path === undefined; else customImg" 
                    [src]="imagePreviews[0]" 
                    class="w-full rounded-lg"
                />

                <ng-template #customImg>
                    <img [src]="selectedImg.path" class="w-full rounded-lg" />
                </ng-template>
            </div>
        }
            <input *ngIf="imagePreviews.length<3"(change)="onFileSelected($event)" accept="image/*" class="p-2 block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-[#c6e6fd] focus:outline-none " type="file">
            <div class="flex max-w-full justify-between ">
                @for (item of imagePreviews; track $index) {
                <a (click)="onSelectImage(item,$index)" class="w-1/4 mr-2">
                    <img  [src]="item" >
                </a>
                }
            </div>
            <span *ngIf="invalid" class="text-red-400 my-3 font-semibold">You must add at least 1 image of the product you want to sell</span>
        </div>
        <div class="w-full lg:col-span-2">
            <div class="lg:flex lg:space-x-5">
            <div class="mt-5 lg:min-w-1/2">
                <label for="base-input" class="text-lg font-semibold text-[#1F2A56] w-20 mb-2">Title</label>
                <input                     
                    formControlName="title" placeholder="Enter your Item Title" type="text" id="base-input" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5">
            </div>
            <div class="mt-5 lg:min-w-1/2">
            <label class="text-lg font-semibold text-[#1F2A56] w-20 mb-2">Price</label>
    
             <div class="flex items-center space-x-2">
                <div class="flex border border-gray-300 rounded-lg overflow-hidden">
                <input
                    type="text"
                    formControlName="price"
                    (change)="calculateCom($event.target)"
                    placeholder="Enter The Price"
                    class="px-3 py-2 text-sm text-gray-900 focus:outline-none"
                />
                <select class="bg-gray-100 text-sm text-gray-700 px-2 border-l border-gray-300 focus:outline-none">
                    <option>EGP</option>
                    <option>USD</option>
                    <option>EUR</option>
                </select>
                </div>
            </div>
            <span *ngIf="netPrice!=0" class="text-[#36478b] font-semibold text-base">The net price after commission will be <span class="font-bold">{{netPrice}}</span> EGP</span>

             </div>
             </div>
             
<div class="lg:flex lg:space-x-5">
            <div class="mt-5 lg:min-w-1/2">
                <label for="condition" class="text-lg font-semibold text-[#1F2A56] w-20 mb-2">Condition</label>
                <select id="condition" aria-placeholder="Choose Your Condition " formControlName="condition" class="block w-full p-2 mb-6 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 ">
                    <option selected>Choose a Condition</option>
                    <option value="new">New</option>
                    <option value="asNew">As New</option>
                    <option value="used">Used</option>
                </select>
            </div>
            
<label class="mt-5 inline-flex items-center cursor-pointer">
  <input type="checkbox"  [(ngModel)]="hasExpiryDate" [ngModelOptions]="{standalone:true}" value="" class="sr-only peer">
  <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-950 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all  peer-checked:bg-blue-600 "></div>
  <span *ngIf="!hasExpiryDate" class="ms-3 text-base font-medium text-[#1F2A56] ">Your item has Expiry Date</span>
</label>

            <div *ngIf="hasExpiryDate" class="mt-5 ">
                <label class="text-lg font-semibold text-[#1F2A56] w-20 mb-2">Expiry Date</label>
                <div class="relative">
                    <p-datepicker formControlName="expiryDate" class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5" />
            
                    <svg
                        class="w-5 h-5 text-gray-500 absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                        ></path>
                    </svg>
                </div>
            </div>
            </div>
            
<div class="lg:flex lg:space-x-5">
            <div class="mt-5 lg:mt-0 lg:min-w-1/2">
                <label for="Category" class="text-lg font-semibold text-[#1F2A56] w-20 mb-2 ">Category</label>
                <select id="Category" (change)="onSelectCategory($event)" formControlName="category" class="block w-full p-2 mb-6 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 ">
                    <option selected>Choose a Category</option>
                    @for (item of categories; track $index) {
                        <option [value]="item.id">{{item.name}}</option>
                    }
                </select>
            </div>
            <div class="mt-5 lg:mt-0 lg:min-w-1/2">
                <label for="subcategory" class="text-lg font-semibold text-[#1F2A56] w-20 mb-2">Subcategory</label>
                <select id="subcategory" (change)="onSelectSubcategory()" formControlName="subcategory" class="block w-full p-2 mb-6 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 ">
                    <option *ngIf="subCategories.length==0" selected>Choose a category first</option>
                    @for (item of subCategories; track $index) {
                        <option [value]="item.id">{{item.name}}</option>
                    }
                </select>
            </div>
        </div>
        <div class="lg:flex lg:space-x-5">
            <div class="mt-5 lg:mt-0 lg:min-w-1/2">
                <label for="Category" class="text-lg font-semibold text-[#1F2A56] w-20 mb-2 ">City</label>
                <select id="Category" formControlName="city" class="block w-full p-2 mb-6 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 ">
                    <option selected>Choose Your City</option>
                    @for (item of cities; track $index) {
                        <option [value]="item">{{item}}</option>
                    }
                    </select>
            </div>
            <div class="lg:min-w-1/2">
                <label  class="text-lg font-semibold text-[#1F2A56] w-20 mb-2">Address</label>
                <input formControlName="address" placeholder="Enter your address " type="text" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5">
            </div>
        </div>
        <div class="flex flex-col max-w-2xl ">
  <label for="description" class="text-[#1F2A56] mb-2 text-lg font-semibold">Product Description</label>

  <quill-editor
  formControlName="description"
  [style]="{height: '150px'}"
  placeholder="Write your product description here..."
></quill-editor>
</div>


        <div class="relative w-full mb-28 mt-15">
            <input type="submit" value="Publish Post" class="absolute lg:text-xl  lg:min-w-1/3 right-0 bg-[#0077B6] text-white font-semibold p-3 rounded-2xl">
        </div>
        
        </div>
        
    </form>
    
</div>
